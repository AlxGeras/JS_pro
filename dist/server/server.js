(()=>{var t={319:t=>{var n=function(t){var n=0,e=0;return t.contents.forEach((function(t){n+=t.quantity*parseFloat(t.price),e+=t.quantity})),t.countGoods=e,t.amount=n,t};t.exports={add:function(t,e){return t.contents.push(e.body),t=n(t),JSON.stringify(t,null,4)},change_add:function(t,e){return t.contents.find((function(t){return t.id_product===+e.params.id})).quantity+=e.body.quantity,t=n(t),JSON.stringify(t,null,4)},del:function(t,e){var r=t.contents.find((function(t){return t.id_product===+e.params.id}));return 1==r.quantity||0==e.body.quantity?(t.contents.splice(t.contents.indexOf(r),1),t=n(t)):(r.quantity+=e.body.quantity,t=n(t)),JSON.stringify(t,null,4)},change:function(t,e){return t.contents.find((function(t){return t.id_product===+e.params.id})).quantity=e.body.quantity,t=n(t),JSON.stringify(t,null,4)}}},508:(t,n,e)=>{var r=e(860),i=e(147),o=e(303),u=r.Router(),s=e(17).resolve(__dirname,"./db/userCart.json");u.get("/",(function(t,n){i.readFile(s,"utf-8",(function(t,e){t?n.sendStatus(404,JSON.stringify({result:0,text:t})):n.send(e)}))})),u.post("/",(function(t,n){o(t,n,"add",s)})),u.put("/:id",(function(t,n){o(t,n,"change_add",s)})),u.put("/change/:id",(function(t,n){o(t,n,"change",s)})),u.delete("/:id",(function(t,n){o(t,n,"del",s)})),u.get("/:id",(function(t,n){o(t,n,"getAtId",s)})),t.exports=u},303:(t,n,e)=>{var r=e(147),i=e(319),o=e(414),u={add:i.add,change_add:i.change_add,change:i.change,del:i.del};t.exports=function(t,n,e,i){r.readFile(i,"utf-8",(function(s,d){if(s)n.sendStatus(404,JSON.stringify({result:0,text:s}));else{var a=u[e](JSON.parse(d),t);r.writeFile(i,a,(function(t){t?n.send('{"result": 0}'):n.send('{"result": 1}')})),o(t,e)}}))}},414:(t,n,e)=>{var r=e(147),i=e(17),o={add:"Добавлен",change:"Добавлен",del:"Удален"},u={add:function(t){return t.body.id_product},change:function(t){return t.params.id},del:function(t){return t.params.id},change_add:function(t){return t.params.id}},s=i.resolve(__dirname,"./db/stat.json"),d=i.resolve(__dirname,"./db/products.json");t.exports=function(t,n){r.readFile(s,(function(e,i){e?console.log(e):r.readFile(d,(function(d,a){if(d)console.log(e);else{var c=JSON.parse(a).find((function(e){return e.id_product===+u[n](t)})),f=JSON.parse(i),l={};l[n]="".concat(o[n]," товар id: ").concat(c.id_product," Наименование: ").concat(c.product_name," Цена: ").concat(c.price," Время ").concat(Date()),f.push(l),r.writeFile(s,JSON.stringify(f,null,4),(function(t){t&&console.log(t)}))}}))}))}},860:t=>{"use strict";t.exports=require("express")},147:t=>{"use strict";t.exports=require("fs")},17:t=>{"use strict";t.exports=require("path")}},n={};function e(r){var i=n[r];if(void 0!==i)return i.exports;var o=n[r]={exports:{}};return t[r](o,o.exports,e),o.exports}(()=>{var t=e(860),n=e(147),r=e(508),i=t(),o=e(17);i.use(t.json()),i.use("/",t.static(o.resolve(__dirname,"../public"))),i.use("/api/cart",r);var u=o.resolve(__dirname,"./db/products.json"),s=o.resolve(__dirname,"./db/productShow.json");i.get("/api/products",(function(t,e){n.readFile(u,"utf-8",(function(t,n){t?e.send(JSON.stringify({result:0,text:t})):e.send(n)}))})),i.get("/api/product",(function(t,e){n.readFile(s,"utf-8",(function(t,n){t?e.send(JSON.stringify({result:0,text:t})):e.send(n)}))})),i.post("/api/product/show",(function(t,e){n.readFile(s,"utf-8",(function(r,i){if(r)e.sendStatus(404,JSON.stringify({result:0,text:r}));else{var o=JSON.parse(i);o.content=[t.body],n.writeFile(s,JSON.stringify(o,null,4),(function(t){t?e.send('{"result": 0}'):e.send('{"result": 1}')}))}}))}));var d=process.env.PORT||3e3;i.listen(d,(function(){console.log("Listening ".concat(d," port"))}))})()})();